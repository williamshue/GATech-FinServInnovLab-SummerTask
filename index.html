<!DOCTYPE html>
<html>
<head>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<style>
</style>
</head>
<body>

<h1 style="width:100%;max-width:700px;margin:0 auto;color:grey;font-weight: 1%;">SEC 10-K Filings Insight Analysis Dashboard</h1>
<div id="myPlot" style="width:100%;max-width:700px;margin:0 auto;"></div>
<div id="info" style="width:100%;max-width:600px;margin:20px auto;border-radius:10px;border:2px solid #000;padding:10px;"></div>

<script>
fetch('data.json')
.then(response => response.json())
.then(data => {
    const years = Object.keys(data.C1);
    const stockPricesC1 = years.map(year => parseFloat(data.C1[year].stock_price.replace('$', '')));
    const stockPricesC2 = years.map(year => parseFloat(data.C2[year].stock_price.replace('$', '')));
    const eventsC1 = years.map(year => `${year}: ${data.C1[year].text}`);
    const eventsC2 = years.map(year => `${year}: ${data.C2[year].text}`);

    const trace1 = {
      x: years,
      y: stockPricesC1,
      mode: "lines+markers",
      name: 'Company 1',
      type: 'scatter'
    };

    const trace2 = {
      x: years,
      y: stockPricesC2,
      mode: "lines+markers",
      name: 'Company 2',
      type: 'scatter'
    };

    const dataPlot = [trace1, trace2];

    const layout = {
      xaxis: {title: "Year"},
      yaxis: {title: "Stock Price ($)"},
      title: "Stock Prices and Events by Year"
    };

    Plotly.newPlot("myPlot", dataPlot, layout);

    const plotDiv = document.getElementById('myPlot');
    plotDiv.on('plotly_hover', function(data){
        const yearIndex = data.points[0].pointIndex;
        const company = data.points[0].data.name;
        let infoText = `<h2>${company}</h2>`;
        if (company === "Company 1") {
            infoText += `<p>${eventsC1[yearIndex]}</p>`;
        } else {
            infoText += `<p>${eventsC2[yearIndex]}</p>`;
        }
        document.getElementById('info').innerHTML = infoText;
    })
    .on('plotly_unhover', function(data){
        document.getElementById('info').innerHTML = '';
    });
})
.catch(error => console.error('Error loading the data:', error));
</script>

</body>
</html>
